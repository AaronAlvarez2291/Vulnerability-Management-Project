# Vulnerability-Management-Project

<h2>Overview</h2>

This project was created and used to gain experience with Nessus Essentials to learn how to scan for vulnerabilities on machines and remediate them. In this lab I will be using Nessus essentials to scan vulnerable virtual machines on my network and then implementing patches to those vulnerable virtual machines. In this lab we will be scanning our vulnerable machines using both credentialed and non-credentialed scans and showing why credentialed scans are better than uncredentialed scans.

<h2>Nessus & VM setup</h2>

The first thing I did when i started this lab was downloading Nessus Essentials my Vulnerability management software. By following this <a href="https://docs.tenable.com/nessus/Content/InstallNessusWindows.htm">documentation</a> i was able to download Nessus Essentials.

<img src="Images/Nessus Essentials Downloading.jpeg">

The Download for Nessus Essentials took a while so while waiting for it finish Downloading I decided to set up my Windows 10 VM. I hosted my VM on <a href="https://www.virtualbox.org/">VirtualBox</a> and I downloaded the Windows 10 iso using <a href="https://support.microsoft.com/en-us/windows/create-installation-media-for-windows-99a58364-8c02-206f-aa6f-40c3b507420d">microsofts installation media</a>. I then configured my VM and its network adapter settings to be bridged so it could be on the same network as my native machine. By following this VM installation <a href="https://pureinfotech.com/create-windows-10-virtual-machine-virtualbox/">documentation</a> I was able to download and configure my virtual machine.

<img src="Images/Virtual Box Network Adapter.png">

After i had setup my VM the installation for Nessus was still taking place. So I then proceeded to launch my VM and check if it was part of my locat network by using the ipconfig command.

<img src="Images/VM IP adreess.png"> 

I then tried to ping the VM from my native computer to see if I can communicate with the VM. The reason I am doing this is because if I can't ping the VM then Nessus won't be able to as well and can't run its scans. As we can see the pings are timing out, meaning my native PC can't establish a connection with it at the moment.

<img src="Images/Ping Failed.png">

The reason my native machine can't establish a connection is because the VM has a firewall active and it is blocking all connection attempts (which is a good thing, but not for the purposes of this lab) so I had to configure the windows firewall to allow pings. By following this <a href="https://kb.iu.edu/d/aopy">documentation</a> i was able to configure the firewall to accept ping requests. By enabling File and Printer Sharing (Echo Request - ICMPv4-In) rule in my firewall we can now see that i am allowed to ping my VM.

https://user-images.githubusercontent.com/120752988/208491183-18c60d21-17e4-44f0-acec-3375f6922f99.mp4

<img src="Images/Pinging VM.png"> 

After i had finished configuring my VM to accept ping requests my Nessus Essentials was finished downnloading. Now the first thing i did in Nessus Essentials was create a new scan and then select basic scan.

<img src="Images/Create new scan.jpeg"> 
<img src="Images/Basic Scan.jpeg"> 

The newly created scan then asks me to give the scan a name and select a target to scan. This target could be a range of ip addresses for eg. 192.168.100.1-192.168.100.10 or a single target. In my case i was scanning a single VM on my network so i put in one IP address. My virtual machines IP address is 192.168.100.200 so thats what i put in the target field.

<img src="Images/Configuring Scan.png"> 

This is the end of configurations for both Nessus Essentials and our virtual machine to see the results of our non-credential and credentialed scans on our VM please read the observation section.

<h2>Running Scans</h2>

After I created the new scan i then launched the scan and waited for the scan to finish. We can tell when a scan is done because it will have a grey checkmark next to it.

<img src="Images/Running Credentialed Scan.jpeg">

![Scan Running](https://user-images.githubusercontent.com/120752988/208498739-9a56aa6a-e2ff-450f-8bf4-5182dbd0a399.gif)

<img src="Images/Scan Complete.jpeg"> 

After it was finished scanning the VM i clicked on the scan and found that there were 46 results, 40 of which are info and 6 medium. We could also see 5 tabs when we click on the host we scanned. We can see a host, vilnerabilities, Remediations, VPR top threats and finally a History tab. The host tab shows us the host which has been scanned and gives us information about what type of vulnerabilities have been found, the vulnerabilities tab shows us all the vulnerablities found and gives us a description of the vulnerabilities, the remediation tab tells us ways we can remediate these vulnerabilities, the VPR top threats tab tells us which vulnerabilities are dangerous and critical, and gives us an idea of the vulnerabilities we should prioritize and finally the history tab shows us a history of all the scans done and their scan results.

<img src="Images/Non-Credential Results.png"> 
<img src="Images/5 tabs.png"> 

This type of scan is known as a non-credentialed scan. A non-credentialed scan is a scan that does not use credentials to scan assets connected to a network. A non-credential scan only retrieves asset information that is exposed to the network and can thus be collected without logging into the asset. This is basic information like the name of the device or the operating system.

I am now going to run a credentialed scan but before I can do this I much first configure Nessus and my VM to allow for this type of scan. So the first thing i am going to do is give my non-credentialed scan credentials to get into the system and scan it. Now since i am using a windows machine i will select the windows tab and enter my windows credentials if i was using a linux or mac machine i would then use SSH.

<img src="Images/Configuring Crednetials on Nessus.png"> 

Now its time for me to configure the VM to allow for a credentialed scan. So the first thing i did was i went into services and enabled remote registry. This will allow Nessus to connect to the VM's registry and properly scan for vulnerabilities such as bad configurations, insecure connections or deprecated cipher suites. I am following this step from Nessus and what they recommended to run a credentialed scan.

[<img src=""> Enabling Remote Registry](https://user-images.githubusercontent.com/120752988/208489911-cd45be46-0d00-40aa-bc7f-e2bdebb9f169.mp4)

After this the next step i did to configure my VM for a credential scan is enable rules and open ports in my firewall. In order to do this i followed this <a href="https://community.tenable.com/s/article/Troubleshooting-Credential-scanning-on-Windows#:~:text=When%20running%20a%20credential%20scan,cannot%20authenticate%20to%20the%20target.&text=The%20Remote%20Registry%20service%20must,administrator%20rights%20on%20the%20target.">documentation</a> to configure everything properly in the firewall. I first opened port 139 and 445 and i lastly enabled these inbound rules: 

<ul>
  <li> File and Printer Sharing (NB-Session-In)</li>
  <li> File and Printer Sharing (SMB-In)</li>
  <li> Windows Management Instrumentation (ASync-In)</li>
  <li> Windows Management Instrumentation (DCOM-In)</li>
  <li> Windows Management Instrumentation (WMI-In)</li>
</ul>

<img src="Images/Open Ports.png">

<img src="Images/File and Printer Sharing.png">

<img src="Images/Windows Management Instrumentation.png">

Finally i opened the registry and added a key that is suppose to allow Nessus to connect in by further disabling user account controls. The key is a Dword key and the name of the key is LocalAccountTokenFilterPolicy and i changed the value to 1.

<img src="Images/Registry.jpeg"> 
<img src="Images/Key Creation.jpeg"> 

When i finshed configuring the VM for a credentialed scan i restarted the machine so the changes i made could take effect and then i ran my credential scan
<img src="Images/Running Credentialed Scan.jpeg">

From the results we can see that the credentialed scan has given us a lot more vulnerabilities than the first one. This is because it is able to scan deeper into the VM due to the vulnerability scanner having credentials. The images below show the differnce between the two. 

<b>Credential Scan</b>

![Credential Scan without old software](https://user-images.githubusercontent.com/120752988/210192332-f30d8a2d-c73d-43a6-9539-9f6172f915ad.jpg)

<b>Non-Credentialed Scan</b>

<img src="Images/Non-Credential Results.png"> 

I then decided to install old software on my virtual machine and do a noncredential and credential scan to further see how a credrential scan can provide better results than a noncredential scan. The old software i installed on my VM was an old version of firefox from <a href="https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/">Directory Listing</a>.

<img src=""> uncredential scan 

After the uncredential scan finished i then ran a credential scan and found that the credential scan provided way more effective results than the umcredentialed scan.

![Screenshot (39)](https://user-images.githubusercontent.com/120752988/210192211-147b9038-d5d0-4419-a0ad-1a7560e63bbc.png)

Now that i found all these vulnerabilities on the system i started the process of remediating the most critical vulnerabilities since they have higher chance of getting exploited by a hacker. I then proceeded to the VPR top threats tab where i saw that the old software i downloaded was a huge vulnerability on the system. On top of Nessus telling us what vulnerabilties there are on the system and giving a description of what thos vulnerabilities could do Nessus also tells us how we could remediate these vulnerabilities. Using the remediation soluction nessus recommended i deleted the old version of firefox and installed the newest version of the software.

<img src="Images/Description of vulnerabilities.png">

https://user-images.githubusercontent.com/120752988/208978636-64569272-2eb7-458e-8cb6-35b75fe0e1b4.mp4

<img src="Images/Installing updated version of software (1).png"> 

<img src="Images/Installing updated version of software (2).png"> 

<img src="Images/Installing updated version of software (3).png"> 

After i finished remediating these critical vulnerabilities i ran another credential scan to see if those vulnerabilities had been fixed. 

![Screenshot (38)](https://user-images.githubusercontent.com/120752988/210192126-55eabc34-6396-4e43-be4f-f3b1af257095.png)

Now from the results provided we can see that most of the vulnerabilities on the system had been remediated. There are still some vulnerabilties remaining on the system but i will remediate them another time since they are not as serious as the vulnerabilities we had just remediated so ill remediate them another time.







